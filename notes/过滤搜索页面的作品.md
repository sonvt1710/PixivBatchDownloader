# 过滤搜索页面的作品

红叶的定制功能：搜索页面显示的作品默认应用下载器的过滤条件，即不显示不想要的作品。

我想拦截 Pixiv 的 API，直接修改请求数据，这样直接处理数据源，比较省心。如果使用修改页面元素的方法就很麻烦，因为作品的 DOM 元素里缺少很多数据，无法进行过滤判断，还是得再去获取数据。

## 使用须知

- 搜索页面顶部的几个“热门作品”和会员宣传区域的几个作品没有单独处理。
- 当你启用此功能、以及修改过滤条件后，页面上显示的作品不会变化，这是正常的，因为它们已经显示出来了。这个功能是通过拦截请求实现的，所以之后发起的请求才会应用你的修改，所以你在翻页、刷新时可以看到修改的效果。
- 由于作品列表的数据里不包含收藏数量，所以下载器不能使用收藏数量来过滤作品。收藏数量条件会被忽略。
- 启用此功能时，请慎重使用“图片色彩”过滤器。如果只选择了一种颜色（也就是需要判断图片的色彩），下载器需要加载所有作品的缩略图来判断颜色，这会产生大量请求，而且也会比较耗时（过滤可能需要超过 2 秒钟）。

## API 网址示例

### 顶部

"顶部"（综合）页面的 API 开头是：
https://www.pixiv.net/ajax/search/top/

或者：
https://www.pixiv.net/ajax/search/artworks/

默认的“顶部”页面是 `/top/`，内容很丰富，在插画列表下方还有小说列表和珍藏集。点击插画区域底部的“查看全部”按钮后会进入 `/artworks` 页面，在此页面里的 api 是 `/artworks/`，没有小说的数据。

PS：`/artworks` 和 `/illustrations` 分类页面里的作品是完全相同的，而且都包含了动图。

返回数据里同时包含插画/漫画数据和小说数据，在不同的 key 里：
- 热门作品的作品数据路径： `body.popular.recent`
- 高级会员区域的作品数据路径： `body.popular.permanent`
- 插画/漫画列表数据路径：`body.illustManga.data`
- 小说列表数据路径：`body.novel.data`（当 api 是 `/top/` 时才有小说数据）

示例：
https://www.pixiv.net/ajax/search/top/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber?lang=zh

### 插画

“插画”分类的 API 开头是：
https://www.pixiv.net/ajax/search/illustrations/

插画列表数据路径：`body.illust.data`

示例：
https://www.pixiv.net/ajax/search/illustrations/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber?word=%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber&order=date_d&mode=all&p=1&csw=0&s_mode=s_tag_full&type=illust_and_ugoira&ai_type=1&lang=zh

### 漫画

“漫画”分类的 API 开头是：
https://www.pixiv.net/ajax/search/manga/

漫画列表数据路径：`body.manga.data`

示例：
https://www.pixiv.net/ajax/search/manga/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber?word=%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber&order=date_d&mode=all&p=1&csw=0&s_mode=s_tag_full&type=manga&lang=zh

### 小说

“小说”分类的 API 开头是：
https://www.pixiv.net/ajax/search/novels/

小说列表数据路径：`body.novel.data`

示例：
https://www.pixiv.net/ajax/search/novels/%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber?word=%E3%83%90%E3%83%BC%E3%83%81%E3%83%A3%E3%83%ABYouTuber&order=date_d&mode=all&p=1&csw=0&s_mode=s_tag_full&gs=0&lang=zh
